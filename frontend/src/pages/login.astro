---
import Layout from "../layouts/Layout.astro";
---

<Layout>
  <section class="flex justify-center items-center min-h-screen bg-neutral-950 px-4">

    <!-- CUADRO DEL FORMULARIO -->
    <div class="w-full max-w-md bg-neutral-900 border border-neutral-800 rounded-2xl p-8 shadow-lg">

      <!-- TÍTULO -->
      <h2 class="text-3xl font-semibold text-rose-300 text-center mb-6">Iniciar sesión</h2>

      <!-- FORMULARIO -->
      <form
        class="flex flex-col gap-4"
        onSubmit={async (e) => {
          e.preventDefault();
          const formData = new FormData(e.target);
          const username = formData.get("username");
          const password = formData.get("password");

          try {
            const res = await fetch("http://127.0.0.1:8000/login", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({ username, password }),
            });

            const data = await res.json();

            if (!res.ok) {
              alert(data.detail || "Error al iniciar sesión");
              return;
            }

            alert("Login exitoso! Token: " + data.access_token);
            // Aquí podés guardar el token y redirigir
          } catch (err) {
            alert("Error de conexión con el servidor");
          }
        }}
      >

        <!-- Usuario -->
        <div class="flex flex-col">
          <label class="text-sm text-neutral-400 mb-1">Usuario</label>
          <input
            type="text"
            name="username"
            placeholder="Tu usuario"
            class="w-full px-4 py-3 rounded-xl bg-neutral-800 border border-neutral-700 text-neutral-200 focus:outline-none focus:border-rose-300 transition"
            required
          />
        </div>

        <!-- Contraseña -->
        <div class="flex flex-col">
          <label class="text-sm text-neutral-400 mb-1">Contraseña</label>
          <input
            type="password"
            name="password"
            placeholder="********"
            class="w-full px-4 py-3 rounded-xl bg-neutral-800 border border-neutral-700 text-neutral-200 focus:outline-none focus:border-rose-300 transition"
            required
          />
        </div>

        <!-- Botón -->
        <button
          type="submit"
          class="w-full py-3 rounded-full bg-rose-300 text-neutral-950 font-semibold hover:bg-rose-400 transition mt-2"
        >
          Ingresar
        </button>

      </form>

      <p class="text-xs text-neutral-400 text-center mt-4">
        ¿No tienes cuenta?
        <a href="/register" class="text-rose-300 hover:underline">Regístrate</a>
      </p>

    </div>
  </section>
</Layout>
